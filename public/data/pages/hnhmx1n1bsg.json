{"content":[{"type":"paragraph","crDate":1754561988140,"chDate":1755074202622,"text":"Bevor React Context eingeführt wurde, mussten Entwickler häufig mit dem sogenannten <i>Prop Drilling</i> umgehen – einer unbeliebten Technik, bei der Props durch mehrere Komponenten-Ebenen hindurch weitergereicht werden müssen, selbst wenn Zwischenkomponenten diese Daten gar nicht benötigen.\nEinzige Alternative war die Verwendung von Tools wie Redux, eine aufwendige und komplexe Lösung, die für die meisten Anwendungen unnötig kompliziert ist."},{"type":"paragraph","crDate":1722952839563,"chDate":1753788517081,"text":"Der Context erlaubt es, an übergeordneter Stelle Daten abzulegen und von Kind-Komponenten aus darauf lesend und schreibend zuzugreifen. Dadurch können Informationen ohne viel Aufwand bei der Parameterübergabe in der ganzen App verwendet werden.\nKern des Contexts ist die <i>createContext()</i>-Methode. Diese legt den Context an und stellt alle Methoden bereit, um mit dem Context arbeiten zu können.\nEs ist ein guter Weg, den Context in einer eigenen Datei anzulegen, um ihn importieren zu können, falls gewünscht."},{"type":"code","crDate":1723035098596,"chDate":1754563152605,"text":"// MyContext.js\nimport {createContext} from 'react';\n\nconst MyContext = createContext({\n car: {\n  marke: 'default',\n  modell: 'default'\n }\n});\n\nexport default MyContext;"},{"type":"paragraph","crDate":1723035121562,"chDate":1771418052162,"text":"<i>createContext()</i> erzeugt einen leeren Context, dermit den Defaults gefüllt ist.\nAchtung: Dieser Context enthält keine Daten, diese werden erst später hinzugefügt. Der Context stellt nur die Kommunikation zur Verfügung."},{"type":"code","crDate":1723035771795,"chDate":1771342341364,"text":"// App.js\nimport MyContext from './MyContext.jsx';\nimport MyComp from './MyComp.jsx';\nimport {useState} from \"react\";\n\nconst App = () => {\n // Definiere den Wert des Contexts\n const [car, setCar] = useState({\n  marke: 'Hyundai',\n  modell: 'i20'\n });\n\n return (\n  &lt;>\n   {/* Stelle den Context-Wert als Objekt bereit */}\n   &lt;MyContext.Provider value={{car, setCar}}>\n    &lt;MyComp />\n   &lt;/MyContext.Provider>\n  &lt;/>\n );\n};\n\nexport default App;"},{"type":"paragraph","crDate":1723035894402,"chDate":1771418302501,"text":"MyContext ist ein Objekt, das ein Attribut namens <i>Provider</i> enthält. Dieser ist eine Komponente, die in JSX eingebunden werden kann.. \nDiese Provider-Komponente wird verwendet, um den Context mit den gewünschten Daten zu füttern.\nDazu wird an den Provider das <i>value</i>-Attribut mit den gewünschten Daten übergeben. Diese stehen dann in der/den aufgerufenen Komponente(n) über den Context zur Verfügung.\nWenn keine Daten über einen Provider eingefügt wurden,. liefert useContext() die default-Werte. Diese können auch nicht verändert werden."},{"type":"code","crDate":1723035891799,"chDate":1771342335948,"text":"import {useContext} from 'react';\nimport MyContext from './MyContext.jsx';\nimport InnerComp from './InnerComp.jsx';\n\nconst MyComp = () => {\n // Verwende den Context-Hook, um den Wert des Contexts abzurufen\n const { car } = useContext(MyContext);\n\n return (\n  &lt;>\n   &lt;div>\n    &lt;p> Marke: {car.marke} &lt;/p>\n    &lt;p> Modell: {car.modell} &lt;/p>\n   &lt;/div>\n   &lt;div>\n    &lt;InnerComp />\n   &lt;/div>\n  &lt;/>\n );\n};\n\nexport default MyComp;"},{"type":"paragraph","crDate":1771418165708,"chDate":1771418199386,"text":"In jeder Komponente, die innerhalb der Provider-Komponenten verschachtelt wird, kann der <i>Context</i> importiert werden. \nDie <i>useContext()</i>-Funktion kann dann in der Komponenten auf die zuvor abgelegten Daten zurückgreifen.\nWeitere Komponenten, die in der Komponenten verschachtelt werden, haben automatisch ebenfalls Zugriff auf die useContext()-Funktion."},{"type":"subheader","crDate":1771341068422,"chDate":1771342305259,"text":"Kompaktere Variante"},{"type":"paragraph","crDate":1771341078548,"chDate":1771342232082,"text":"Der Umgang mit dem Context kann auch etwas kompakter gestaltet werden.\nWährend wir im Beispiel oben die einzelnen Schritte in eigene Module aufgeteilt haben, lass uns die Elemente zu einem <i>customHook</i> zusammenfassen.\nIm folgenden Beispiel soll eine Liste der Planeten bereitgestellt werden.\nWir legen dazu eine Komponente an, die alle Elemente enthält, um die Daten bereitzustellen.\n<i>createContext()</i> erstellt den Container, der vom Provider gefüllt wird.\n<i>PlanetsProvider()</i> ist eine fertige Komponente, in der bereits der Context-Provider eingebunden ist und übergebene Children (<a href=\"/?id=9jrbyz89uzo\">Link</a>) verschachtelt.\n<i>usePlanets()</i> stellt die Daten aus dem Context in allen Children zur Verfügung."},{"type":"code","crDate":1771342235281,"chDate":1771342299393,"text":"import {createContext, useState, useContext} from 'react';\n\nconst PlanetsContext = createContext({\n planets: []\n})\n\nexport const PlanetsProvider = ({children}) => {\n const [planets] = useState([\n  {id: 1, name: 'Mercury'},\n  {id: 2, name: 'Venus'},\n  {id: 3, name: 'Earth'},\n  {id: 4, name: 'Mars'}\n ])\n\n return (\n  &lt;PlanetsContext.Provider value={planets}>\n   {children}\n  &lt;/PlanetsContext.Provider>\n )\n}\n\nexport const usePlanets = () => useContext(PlanetsContext)"},{"type":"paragraph","crDate":1771342379106,"chDate":1771342534470,"text":"In der App wird dann <i>Provider</i> eingebunden, der über einen <i>benannten Export</i> zur Verfügung gestellt wurde.\nIn die Provider-Komponente wird die <i>Planetslist-Komponente</i> verschachtelt, die ja im PlanetsProvder als <i>Children</i> eingehängt ist."},{"type":"code","crDate":1771342412525,"chDate":1771342690346,"text":"import {PlanetsProvider} from \"./PlanetsContext.jsx\";\nimport Planetslist from \"./Planetslist.jsx\";\n\nconst App = () => {\n return (\n  &lt;>\n   &lt;h1>App&lt;/h1>\n   &lt;PlanetsProvider>\n    &lt;Planetslist/>\n   &lt;/PlanetsProvider>\n  &lt;/>\n )\n}\n\nexport default App"},{"type":"paragraph","crDate":1771342584513,"chDate":1771342677535,"text":"Fehlt nur noch die Komponente zur Darstellung. Die Planetslist.jx.\nIn dieser wird die <i>usePlanets()</i>-Funktion verwendet, um Zugriff auf die Daten zu gewährleisten."},{"type":"code","crDate":1771342614193,"chDate":1771342687318,"text":"import {usePlanets} from \"./PlanetsContext.jsx\";\n\nconst Planetslist = () => {\n const planets = usePlanets()\n return (\n  &lt;ul>\n   {planets.map(planet => &lt;li key={planet.id}>{planet.name}&lt;/li>)}\n  &lt;/ul>\n )\n}\n\nexport default Planetslist;"},{"type":"subheader","crDate":1771340194235,"chDate":1771340205278,"text":"Daten ändern"},{"type":"paragraph","crDate":1771340207396,"chDate":1771421959044,"text":"Da ein Context im Prinzip nur eine Weiterleitung eines State in eine andere Komponente ist, kann der State auch entsprechend verändert werden. Wir müssen nur die setPlanets()-Funktion in unsere App bekommen.\nZunächst fügen wir einen Platzhalter für die Funktion zur Verfügung, welche die Daten überschreibt.\nDazu erweitern wir den Context um das Attribut setPlanets.\nDann wird diese Funktion im Provider eingefügt. Nämlich einmal beim Aufruf von <i>useState()</i>, um die Funktion überhaupt zu bekommen.\nUnd im <i>value</i> des Providers. <b>Achtung</b>: Aus dem einfachen Wert wird hier ein Objekt gemacht."},{"type":"code","crDate":1771421543541,"chDate":1771422165791,"text":"import {createContext, useState, useContext} from 'react';\n\nconst PlanetsContext = createContext({\n planets: [],\n setPlanets: () => { }\n})\n\nexport const PlanetsProvider = ({children}) => {\n const [planets, setPlanets] = useState([\n  {id: 1, name: 'Mercury'},\n  {id: 2, name: 'Venus'},\n  {id: 3, name: 'Earth'},\n  {id: 4, name: 'Mars'}\n ])\n\n return (\n  &lt;PlanetsContext.Provider value={{planets, setPlanets}}>\n   {children}\n  &lt;/PlanetsContext.Provider>\n )\n}\n\nexport const usePlanets = () => useContext(PlanetsContext)"},{"type":"paragraph","crDate":1771421581552,"chDate":1771422028187,"text":"Schließlich muss in der Komponente zur Anzeige die Funktion eingebunden werden.\nDazu entnehmen wir aus usePlanets() (in diesem Beispiel) per <i>Object-Destructuring</i> die Attribute, u.a. setPlanets.\nDamit kann dann später ein neuer Wert hinzugefügt werden."},{"type":"code","crDate":1771421846153,"chDate":1771422160830,"text":"import {usePlanets} from \"./PlanetsContext.jsx\";\n\nconst Planetslist = () => {\n const {planets, setPlanets} = usePlanets()\n\n const addPlanet = () => {\n  let myPlanet = { id:planets.length+1, name:`Planet X` }\n  setPlanets([...planets, myPlanet])\n }\n\n return (\n  &lt;>\n   &lt;ul>\n    {planets.map(planet => &lt;li key={planet.id}>{planet.name}&lt;/li>)}\n   &lt;/ul>\n   &lt;button onClick={addPlanet}> Add &lt;/button>\n  &lt;/>\n )\n}\n\nexport default Planetslist;"}]}