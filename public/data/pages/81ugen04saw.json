{"content":[{"type":"paragraph","crDate":1770042446179,"chDate":1770125356153,"text":"Der beste Weg, die Funktionsweise zu verstehes, ist vermutlich ein einfaches Beispiel.\nWir wollen Schritt für Schritt eine einfache Shop-Anwendung entwickeln. Zunächst nur mit einem Katalog, dann fügen wir einen Warenkorb.hinzu.\nWir setzen auf Redux Toolkit, einer erweiterten Version von Redux, speziell für React. Das machen wir, um nicht selbst auf Unveränderlichkeit und Serialisierung achten zu müssen."},{"type":"subheader","crDate":1770043081598,"chDate":1770043100803,"text":"Store"},{"type":"paragraph","crDate":1770043102746,"chDate":1770124128703,"text":"Zunächst legen wir den Store an, in dem die Nutzdaten abgelegt werden sollen. \n├ src\n├─ store\n└── index.js\nDazu legen wir einen Unterordner namens <i>store</i> in <i>src</i> an. In diesem legen wir eine <i>index.js</i> an.\nDies index.js ist ein Platzhalter, in dem die Slices hinterlegt werden.\nIn die index.js wird der erste Slice importiert und dessen Reducer registriert."},{"type":"code","crDate":1770043585045,"chDate":1770043591926,"text":"import { configureStore } from '@reduxjs/toolkit';\nimport catalogReducer from './slices/catalogSlice.js';\n\nexport const store = configureStore({\n reducer: {\n  catalog: catalogReducer\n },\n});\n"},{"type":"subheader","crDate":1770122482810,"chDate":1770122487120,"text":"Slice"},{"type":"paragraph","crDate":1770122489748,"chDate":1770210069590,"text":"Als nächstes erzeugen wir den <i>Slice</i> für den Katalog.\n├ src\n├─ store\n├── <i>slices</i>\n├─── <i>catalogSlice.js</i>\n└── index.js\nDen Slice können wir uns vorstellen wie eine Scheibe der Gesamtdaten, in denen nur die Katalog-Daten behandelt werden.\nIm Slice werden die initialen Nutzdaten als <i>State</i> abgelegt.\nDieser State wird dann durch die Funktion <i>createSlice()</i> mit den <i>Reducern</i> kombiniert. Diese Reducer sind Funktionen, um die Nutzdaten zu ändern.\nIn diesem Beispiel gibt es einige Reducer-Methoden. Diese sind die Werkzeuge, um mit den Nutzdaten zu arbeiten.\nDie <i>setItems()</i>-Methode überschreibt die bisherigen Nutzdaten durch ein neues Array.\n<i>getItemById()</i> sucht einen Datensatz mit der gegebenen id und gibt diesen zurück.\n<i>getItemsByPriceRange()</i> erwartet als payload einen min- und einen max-Wert. Dann gibt der Reducer alle Datensätze aus, deren Preis in diesem Bereich liegt.\nAus den <i>Reducern</i> erzeugt createSlice() automatisch die Actions mit denselben Namen. \nIn den Reducer enthalt der Parameter <i>state</i> den state dieses Slice'. <i>Action</i> enthält die Nutzdaten. "},{"type":"code","crDate":1770123915321,"chDate":1770128501465,"text":"import {createSlice} from '@reduxjs/toolkit';\n\nconst initialState =  {\n items: []\n};\n\nconst catalogSlice = createSlice({\n name: 'catalog',\n initialState,\n reducers: {\n  setItems: (state, action) => {\n   state.items = action.payload;\n  },\n  getItemById: (state, action) => {\n   return state.items.find(item => item.id === action.payload);\n  },\n  getItemsByPriceRange: (state, action) => {\n   const { min, max } = action.payload;\n   return state.items.filter(item => item.price >= min && item.price <= max);\n  }\n },\n});\n\nexport const { setItems } = catalogSlice.actions;\nexport default catalogSlice.reducer;"},{"type":"subheader","crDate":1770124493884,"chDate":1770124501142,"text":"Component zur Anzeige"},{"type":"paragraph","crDate":1770124505448,"chDate":1770207360455,"text":"In diesem Beispiel wollen wir den Katalog als Ganzes sehen. Wir brauchen also eine Komponente für den Katalog.\n├ src\n├─ store\n├── slices\n├─── catalogSlice.js\n├── index.js\n└─ <i>Catalog.jsx</i>\nDer useSelector-Hook erlaubt den Zugriff auf die Daten des Hook. Um die Daten unveränderlich zu halten, erwartet der Hook eine Funktion als Argument. Diese Funktion bekommt automatisch den State als Parameter übergeben und gibt den Slice, der im State definiert wurde, zurück.\nDieser Teil wird in der Konstanten <i>products</i> hinterlegt und in der Rückgabe mittels <i>map()</i> zu Komponenten gerendert und ausgegeben."},{"type":"code","crDate":1770124794102,"chDate":1770125617161,"text":"import { useSelector } from 'react-redux';\n\nexport const Catalog = () => {\n const products = useSelector((state) => state.catalog.items);\n\n return (\n  &lt;div>\n   &lt;h2>Katalog&lt;/h2>\n    &lt;ul>\n     {products.map((product) => (\n      &lt;li key={product.id}>\n       {product.name} – {product.price}€\n       &lt;button>\n        In Warenkorb\n       &lt;/button>\n      &lt;/li>\n     ))}\n    &lt;/ul>\n   &lt;/div>\n  );\n}\n"},{"type":"subheader","crDate":1770125434857,"chDate":1770125449315,"text":"Hauptdatei mit Ajax"},{"type":"paragraph","crDate":1770125452662,"chDate":1770209747836,"text":"Schließlich legen wir die Haupt-Datei an, in der alle Fäden zusammenlaufen.\n├ src\n├─ store\n├── slices\n├─── catalogSlice.js\n├── index.js\n├─ Catalog.jsx\n└─ <i>App.jsx</i>\nIn der Hauptdatei werden u.a. <i>useDispatch()</i> importiert. \nNach dem erfolgreichen Laden per <i>Ajax</i> wird <i>dispatch()</i> (dt.: \"versenden\") aufgerufen. An dispatch() übergeben wir die Action, die wir aus dem Slice geladen haben. Dadurch wird der Reducer ausgeführt, welcher mit der Action zusammenhängt. Dieser trägt die neuen Nutzdaten in den Store ein..\n"},{"type":"code","crDate":1770125550624,"chDate":1770125603141,"text":"import React, {useEffect} from 'react';\nimport {useDispatch} from 'react-redux';\nimport {setItems} from './store/slices/catalogSlice.js';\nimport {Catalog} from './Catalog.jsx';\n\nconst App = () => {\n const dispatch = useDispatch();\n\n useEffect(() => {\n  fetch('/catalog.json')\n   .then(response => response.json())\n   .then(data => {\n    dispatch(setItems(data));\n   })\n   .catch(error => console.error('Error loading catalog:', error));\n  }, [dispatch]);\n\n  return (\n   &lt;div className=\"App\">\n    &lt;Catalog />\n   &lt;/div>\n  );\n}\n\nexport default App;"},{"type":"subheader","crDate":1770208781280,"chDate":1770208788184,"text":"Zusammengefasst"},{"type":"paragraph","crDate":1770208790956,"chDate":1770209523593,"text":"<ul>\n<li>Ein Slice ist ein Bereich, in dem die Daten zu einem Teilbereich gehalten werden.</li>\n<li>Der Store ist der Speicher, in dem die gesamten Nutzdaten gehalten werden, und in dem alle Slices zusammengefasst sind.</li>\n<li>Ein Slice enthält reducer-Funktionen, deren Zweck es ist, die Daten im Store zu manipulieren.</li>\n<li>Zu jedem Slice gehört eine action, welche die Nutzdaten an den Reducer überträgt.</li>\n<li>Die dispatch()-Funktion wird verwendet, um eine Aktion an den Store zu senden, der dann den entsprechenden Reducer aufruft, um den Zustand zu aktualisieren.</li>\n<li>useSelector erlaubt es uns, aus dem Store auf die Daten eines Slices zuzugreifen.</li>\n</ul>"}]}